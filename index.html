<style>
:root {
  --primary: #8B4513;
  --secondary: #DEB887;
  --accent: #FFD700;
}

body {
  background: #87CEEB; /* Sky blue background */
  position: relative;
  min-height: 100vh;
  overflow-x: hidden;
  color: var(--secondary);
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  user-select: none;
}

.zoo-background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  pointer-events: none;
}

.jungle-background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  pointer-events: none;
  opacity: 0;
  transition: opacity 1s;
}

.jungle-mode .jungle-background {
  opacity: 1;
}

.jungle-mode .zoo-background {
  opacity: 0;
}

.jungle-mode {
  background: #2F4F2F;
}

.level-transition {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: black;
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s;
}

.level-transition.active {
  opacity: 1;
  pointer-events: all;
}

#monkey {
  width: 200px;
  height: 200px;
  cursor: pointer;
  transition: transform 0.1s;
}

#monkey:active {
  transform: scale(0.95);
}

.stats, .shop-item, .merge-station, h1, h2 {
  background: rgba(44, 24, 16, 0.9);
  padding: 15px;
  border-radius: 10px;
  backdrop-filter: blur(5px);
}

.shop {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin: 20px;
  max-width: 800px;
}

.shop-item {
  background: var(--primary);
  padding: 15px;
  border-radius: 10px;
  cursor: pointer;
  transition: transform 0.2s;
}

.shop-item:hover {
  transform: scale(1.05);
}

.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.egg {
  animation: wobble 2s infinite;
}

.hatching-egg {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 200px;
  height: 200px;
  z-index: 100;
}

.hatching-egg svg {
  width: 100%;
  height: 100%;
  animation: hatchWobble 0.5s infinite;
}

.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  z-index: 99;
  display: flex;
  justify-content: center;
  align-items: center;
}

@keyframes wobble {
  0% { transform: rotate(-5deg); }
  50% { transform: rotate(5deg); }
  100% { transform: rotate(-5deg); }
}

@keyframes hatchWobble {
  0% { transform: rotate(-10deg); }
  50% { transform: rotate(10deg); }
  100% { transform: rotate(-10deg); }
}

@keyframes crack {
  0% { transform: scale(1); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

#inventory {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin: 20px;
  max-width: 800px;
}

.monkey-card {
  background: var(--primary);
  padding: 10px;
  border-radius: 5px;
  width: 100px;
  cursor: pointer;
  transition: transform 0.2s;
  backdrop-filter: blur(5px);
}

.monkey-card:hover {
  transform: scale(1.1);
}

.monkey-card.equipped {
  border: 3px solid var(--accent);
}

.chances-list {
  font-size: 12px;
  text-align: left;
  margin-top: 10px;
  list-style: none;
  padding: 0;
}

.chances-list li {
  margin: 2px 0;
  display: flex;
  justify-content: space-between;
}

/* Add new CSS for merge station */
.merge-station {
  background: var(--primary);
  padding: 20px;
  border-radius: 10px;
  margin: 20px;
  border: 2px solid var(--accent);
}

.merge-options {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 10px;
}

.merge-button {
  background: var(--secondary);
  color: var(--primary);
  padding: 10px;
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.2s;
}

.merge-button:hover:not(.disabled) {
  transform: scale(1.05);
}

.merge-button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.jungle-item {
  background: rgba(47, 79, 47, 0.9) !important;
  border: 2px solid #90EE90;
}

.jungle-item:hover {
  border-color: #FFD700;
}

.rebirth-item {
  background: linear-gradient(45deg, #FF1493, #9400D3) !important;
  border: 2px solid #FFD700;
  color: white;
  text-shadow: 1px 1px 2px black;
}

.rebirth-counter {
  position: fixed;
  top: 10px;
  right: 10px;
  background: rgba(0, 0, 0, 0.8);
  padding: 10px;
  border-radius: 5px;
  color: #FFD700;
  font-weight: bold;
}
</style>
</head>
<body>
  <div class="rebirth-counter">
    Rebirth Level: <span id="rebirthLevelTop">0</span>
  </div>

  <div class="zoo-background">
    <svg width="100%" height="100%" preserveAspectRatio="xMidYMid slice">
      <!-- Ground -->
      <rect x="0" y="70%" width="100%" height="30%" fill="#90EE90"/>
      
      <!-- Fence -->
      <g id="fence" transform="translate(0, 65%)">
        <path d="M0 0 L100% 0" stroke="#8B4513" stroke-width="5"/>
        <g id="fence-posts">
          <path d="M10 -20 L10 20 M30 -20 L30 20 M50 -20 L50 20 M70 -20 L70 20 M90 -20 L90 20" 
                stroke="#8B4513" stroke-width="5" stroke-linecap="round"
                transform="translate(0, 0) scale(1, 1)"/>
        </g>
      </g>

      <!-- Trees -->
      <g class="tree" transform="translate(10%, 60%)">
        <path d="M-20 0 Q0 -40 20 0 Z" fill="#228B22"/>
        <rect x="-5" y="0" width="10" height="20" fill="#8B4513"/>
      </g>
      
      <g class="tree" transform="translate(80%, 55%)">
        <path d="M-25 0 Q0 -50 25 0 Z" fill="#228B22"/>
        <rect x="-6" y="0" width="12" height="25" fill="#8B4513"/>
      </g>

      <!-- Clouds -->
      <g class="cloud" transform="translate(20%, 20%)">
        <circle cx="0" cy="0" r="20" fill="white"/>
        <circle cx="-15" cy="0" r="15" fill="white"/>
        <circle cx="15" cy="0" r="15" fill="white"/>
      </g>

      <g class="cloud" transform="translate(70%, 15%)">
        <circle cx="0" cy="0" r="25" fill="white"/>
        <circle cx="-20" cy="0" r="20" fill="white"/>
        <circle cx="20" cy="0" r="20" fill="white"/>
      </g>

      <!-- Sun -->
      <circle cx="90%" cy="10%" r="30" fill="#FFD700"/>
      
      <!-- Bird silhouettes -->
      <g class="birds">
        <path d="M0 0 Q5 -5 10 0 Q15 -5 20 0" 
              fill="none" stroke="#000" stroke-width="2"
              transform="translate(30%, 25%) scale(0.5)"/>
        <path d="M0 0 Q5 -5 10 0 Q15 -5 20 0" 
              fill="none" stroke="#000" stroke-width="2"
              transform="translate(35%, 20%) scale(0.5)"/>
      </g>
    </svg>
  </div>

  <div class="jungle-background">
    <svg width="100%" height="100%" preserveAspectRatio="xMidYMid slice">
      <!-- Dense jungle ground -->
      <rect x="0" y="70%" width="100%" height="30%" fill="#1a472a"/>
      
      <!-- Jungle plants and vines -->
      <g class="jungle-foliage">
        <!-- Large palm trees -->
        <g transform="translate(10%, 50%)">
          <path d="M-40 0 C-30 -40 30 -40 40 0" fill="#0f5132"/>
          <path d="M-30 -10 C-20 -50 20 -50 30 -10" fill="#1a472a"/>
          <rect x="-8" y="0" width="16" height="40" fill="#4a3728"/>
        </g>
        
        <g transform="translate(80%, 45%)">
          <path d="M-45 0 C-35 -45 35 -45 45 0" fill="#0f5132"/>
          <path d="M-35 -15 C-25 -55 25 -55 35 -15" fill="#1a472a"/>
          <rect x="-10" y="0" width="20" height="50" fill="#4a3728"/>
        </g>
        
        <!-- Vines -->
        <path d="M0,0 Q50,-20 100,0 Q150,-20 200,0" 
              stroke="#2d5a27" 
              fill="none" 
              stroke-width="3"
              transform="translate(0, 20%)"/>
        
        <path d="M50,0 Q100,-30 150,0 Q200,-30 250,0" 
              stroke="#2d5a27" 
              fill="none" 
              stroke-width="3"
              transform="translate(-50, 30%)"/>
              
        <!-- Jungle mist -->
        <rect x="0" y="0" width="100%" height="100%" 
              fill="url(#jungle-mist)"/>
      </g>
      
      <defs>
        <linearGradient id="jungle-mist" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="rgba(47, 79, 47, 0.8)"/>
          <stop offset="100%" stop-color="rgba(47, 79, 47, 0)"/>
        </linearGradient>
      </defs>
    </svg>
  </div>

  <div class="level-transition"></div>

  <h1>Monkey Clicker Empire</h1>
  
  <svg id="monkey" viewBox="0 0 100 100" onclick="clickMonkey()">
    <circle cx="50" cy="50" r="35" fill="#8B4513"/>
    <circle cx="25" cy="35" r="12" fill="#8B4513"/>
    <circle cx="75" cy="35" r="12" fill="#8B4513"/>
    <circle cx="25" cy="35" r="8" fill="#6B3410"/>
    <circle cx="75" cy="35" r="8" fill="#6B3410"/>
    <circle cx="40" cy="45" r="6" fill="white"/>
    <circle cx="60" cy="45" r="6" fill="white"/>
    <circle cx="40" cy="45" r="3" fill="black"/>
    <circle cx="60" cy="45" r="3" fill="black"/>
    <ellipse cx="50" cy="55" rx="7" ry="5" fill="#6B3410"/>
    <path d="M 40 65 Q 50 70 60 65" fill="none" stroke="#6B3410" stroke-width="2"/>
    <ellipse cx="50" cy="60" rx="15" ry="12" fill="#9B5523" opacity="0.5"/>
  </svg>

  <div class="stats">
    <div>Bananas: <span id="bananas">0</span></div>
    <div>Bananas per Click: <span id="bpc">1</span></div>
    <div>Bananas per Second: <span id="bps">0</span></div>
  </div>

  <div class="shop">
    <div class="shop-item" onclick="buyUpgrade('clickPower')">
      <h3>Better Clicking</h3>
      <p>Cost: <span id="clickPowerCost">10</span> bananas</p>
      <p>+5 Bananas per Click</p>
    </div>
    <div class="shop-item" onclick="buyUpgrade('autoClick')">
      <h3>Auto Clicker</h3>
      <p>Cost: <span id="autoClickCost">50</span> bananas</p>
      <p>+1 Banana per Second</p>
    </div>
    <div class="shop-item egg" onclick="buyEgg()">
      <h3>Mystery Egg</h3>
      <p>Cost: <span id="eggCost">100</span> bananas</p>
      <p>Hatch a new monkey!</p>
      <ul class="chances-list">
        <li><span>Common Brown Monkey</span> <span>50%</span></li>
        <li><span>Uncommon Red Monkey</span> <span>25%</span></li>
        <li><span>Rare Golden Monkey</span> <span>15%</span></li>
        <li><span>Epic Rainbow Monkey</span> <span>9%</span></li>
        <li><span>Legendary Galaxy Monkey</span> <span>1%</span></li>
      </ul>
    </div>
    <div class="shop-item" onclick="buyMergeStation()">
      <h3>Merge Station</h3>
      <p>Cost: 10000 bananas</p>
      <p>Merge your monkeys!</p>
    </div>
    <div class="shop-item" onclick="buyJungleAccess()">
      <h3>Jungle Access</h3>
      <p>Cost: 100000 bananas</p>
      <p>Enter the mysterious jungle!</p>
    </div>
    <div class="shop-item" onclick="buyUpgrade('eggLuck')">
      <h3>Lucky Charms</h3>
      <p>Cost: <span id="eggLuckCost">500</span> bananas</p>
      <p>+5% chance for rarer monkeys</p>
    </div>
    <div class="shop-item jungle-item" style="display: none;" onclick="buyUpgrade('jungleClick')">
      <h3>Jungle Training</h3>
      <p>Cost: <span id="jungleClickCost">50000</span> bananas</p>
      <p>+50 Bananas per Click</p>
    </div>
    <div class="shop-item jungle-item egg" style="display: none;" onclick="buyJungleEgg()">
      <h3>Jungle Egg</h3>
      <p>Cost: <span id="jungleEggCost">100000</span> bananas</p>
      <p>Hatch an exotic monkey!</p>
      <ul class="chances-list">
        <li><span>Rare Jungle Monkey</span> <span>60%</span></li>
        <li><span>Epic Vine Swinger</span> <span>30%</span></li>
        <li><span>Legendary Spirit Monkey</span> <span>10%</span></li>
      </ul>
    </div>
    <div class="shop-item jungle-item egg" style="display: none;" onclick="buyMysticalEgg()">
      <h3>Mystical Egg</h3>
      <p>Cost: <span id="mysticalEggCost">250000</span> bananas</p>
      <p>Hatch a mystical being!</p>
      <ul class="chances-list">
        <li><span>Ancient Monkey Sage</span> <span>70%</span></li>
        <li><span>Ethereal Monkey</span> <span>25%</span></li>
        <li><span>Monkey God</span> <span>5%</span></li>
      </ul>
    </div>
    <div class="shop-item rebirth-item" onclick="rebirth()">
      <h3>Rebirth</h3>
      <p>Cost: 10,000,000 bananas</p>
      <p>Reset everything but gain permanent boosts!</p>
      <p>Current Rebirth Level: <span id="rebirthLevel">0</span></p>
      <p>Current Bonus: <span id="rebirthBonus">0</span>x</p>
    </div>
  </div>

  <div id="mergeStation" style="display: none;" class="merge-station">
    <h2>Monkey Merge Station</h2>
    <div class="merge-options">
      <button class="merge-button" onclick="mergeMonkeys('Rare Golden Monkey')">
        Merge 5 Red Monkeys → 1 Golden Monkey
      </button>
      <button class="merge-button" onclick="mergeMonkeys('Epic Rainbow Monkey')">
        Merge 5 Golden Monkeys → 1 Rainbow Monkey
      </button>
      <button class="merge-button" onclick="mergeMonkeys('Legendary Galaxy Monkey')">
        Merge 5 Rainbow Monkeys → 1 Galaxy Monkey
      </button>
    </div>
  </div>

  <h2>Monkey Collection</h2>
  <div id="inventory"></div>

<script>
const game = {
  bananas: 0,
  bananasPerClick: 1,
  bananasPerSecond: 0,
  clickPowerCost: 10,
  autoClickCost: 50,
  eggCost: 100,
  eggLuck: 0,
  eggLuckCost: 500,
  jungleClickCost: 50000,
  jungleEggCost: 100000,
  mysticalEggCost: 250000,
  monkeys: [],
  equippedMonkey: null,
  inJungle: false,
  rebirthLevel: 0,
  rebirthBonus: 1,
};

const monkeyTypes = [
  { name: "Common Brown Monkey", clickValue: 10, chance: 0.50, color: "#8B4513" },
  { name: "Uncommon Red Monkey", clickValue: 50, chance: 0.25, color: "#CD5C5C" },
  { name: "Rare Golden Monkey", clickValue: 100, chance: 0.15, color: "#FFD700" },
  { name: "Epic Rainbow Monkey", clickValue: 250, chance: 0.09, color: "rainbow", isRainbow: true },
  { name: "Legendary Galaxy Monkey", clickValue: 500, chance: 0.01, color: "#4B0082" }
];

const jungleMonkeys = [
  { name: "Rare Jungle Monkey", clickValue: 1000, chance: 0.60, color: "#228B22" },
  { name: "Epic Vine Swinger", clickValue: 2500, chance: 0.30, color: "#32CD32" },
  { name: "Legendary Spirit Monkey", clickValue: 5000, chance: 0.10, color: "#98FB98" }
];

const mysticalMonkeys = [
  { name: "Ancient Monkey Sage", clickValue: 10000, chance: 0.70, color: "#4B0082" },
  { name: "Ethereal Monkey", clickValue: 25000, chance: 0.25, color: "#9400D3" },
  { name: "Monkey God", clickValue: 100000, chance: 0.05, color: "radial-gradient(circle at center, #FFD700, #FFA500)" }
];

function updateDisplay() {
  document.getElementById('bananas').textContent = Math.floor(game.bananas);
  document.getElementById('bpc').textContent = (game.bananasPerClick * game.rebirthBonus).toFixed(1);
  document.getElementById('bps').textContent = (game.bananasPerSecond * game.rebirthBonus).toFixed(1);
  document.getElementById('clickPowerCost').textContent = game.clickPowerCost;
  document.getElementById('autoClickCost').textContent = game.autoClickCost;
  document.getElementById('eggCost').textContent = game.eggCost;
  document.getElementById('eggLuckCost').textContent = game.eggLuckCost;

  // Update new costs
  if (game.inJungle) {
    document.getElementById('jungleClickCost').textContent = game.jungleClickCost;
    document.getElementById('jungleEggCost').textContent = game.jungleEggCost;
    document.getElementById('mysticalEggCost').textContent = game.mysticalEggCost;
  }

  // Update rebirth info
  document.getElementById('rebirthLevel').textContent = game.rebirthLevel;
  document.getElementById('rebirthLevelTop').textContent = game.rebirthLevel;
  document.getElementById('rebirthBonus').textContent = game.rebirthBonus.toFixed(1);
}

function canAfford(item) {
  if (item.textContent.includes('Better Clicking')) return game.bananas >= game.clickPowerCost;
  if (item.textContent.includes('Auto Clicker')) return game.bananas >= game.autoClickCost;
  if (item.textContent.includes('Mystery Egg')) return game.bananas >= game.eggCost;
  if (item.textContent.includes('Lucky Charms')) return game.bananas >= game.eggLuckCost;
  if (item.textContent.includes('Merge Station')) return game.bananas >= 10000;
  if (item.textContent.includes('Jungle Access')) return game.bananas >= 100000;
  if (item.textContent.includes('Jungle Training')) return game.bananas >= game.jungleClickCost;
  if (item.textContent.includes('Jungle Egg')) return game.bananas >= game.jungleEggCost;
  if (item.textContent.includes('Mystical Egg')) return game.bananas >= game.mysticalEggCost;
  if (item.textContent.includes('Rebirth')) return game.bananas >= 10000000;
  return false;
}

function clickMonkey() {
  game.bananas += game.bananasPerClick * game.rebirthBonus;
  updateDisplay();
}

function equipMonkey(index) {
  // Get current base bananasPerClick (excluding any equipped monkey bonuses)
  let baseClickValue = 1; // always start with base value of 1
  
  // Add any upgrades from Better Clicking purchases (multiply by 5 since each upgrade gives 5 now)
  baseClickValue += (Math.log(game.clickPowerCost/10) / Math.log(1.3)) * 5;
  
  // Set the equipped monkey
  game.equippedMonkey = game.monkeys[index];
  
  // Add the base click value AND the monkey's value together
  game.bananasPerClick = baseClickValue + game.equippedMonkey.clickValue;
  
  updateDisplay();
  updateInventory();
}

function buyUpgrade(type) {
  if (type === 'clickPower' && game.bananas >= game.clickPowerCost) {
    game.bananas -= game.clickPowerCost;
    game.bananasPerClick += 5; // Changed from 1 to 5
    game.clickPowerCost = Math.ceil(game.clickPowerCost * 1.3);
  } else if (type === 'autoClick' && game.bananas >= game.autoClickCost) {
    game.bananas -= game.autoClickCost;
    game.bananasPerSecond += 1;
    game.autoClickCost = Math.ceil(game.autoClickCost * 1.3);
  } else if (type === 'eggLuck' && game.bananas >= game.eggLuckCost) {
    game.bananas -= game.eggLuckCost;
    game.eggLuck += 5;
    game.eggLuckCost = Math.ceil(game.eggLuckCost * 1.5);
  } else if (type === 'jungleClick' && game.bananas >= game.jungleClickCost) {
    game.bananas -= game.jungleClickCost;
    game.bananasPerClick += 50; // Changed from 5 to 50
    game.jungleClickCost = Math.ceil(game.jungleClickCost * 1.5);
  }
  updateDisplay();
}

function showEggAnimation(monkeyType) {
  const overlay = document.createElement('div');
  overlay.className = 'overlay';
  
  const eggContainer = document.createElement('div');
  eggContainer.className = 'hatching-egg';
  
  const eggSvg = `
    <svg viewBox="0 0 100 100">
      <ellipse cx="50" cy="60" rx="30" ry="40" fill="#FFF" />
      <path id="crack" d="M 50 20 L 50 60" stroke="#333" stroke-width="0" />
    </svg>
  `;
  
  eggContainer.innerHTML = eggSvg;
  overlay.appendChild(eggContainer);
  document.body.appendChild(overlay);
  
  setTimeout(() => {
    const crack = overlay.querySelector('#crack');
    crack.style.strokeWidth = "2";
    eggContainer.style.animation = "crack 0.5s";
    
    setTimeout(() => {
      let monkeyFill = monkeyType.color;
      if (monkeyType.name === "Epic Rainbow Monkey") {
        // Add rainbow gradient definition
        monkeyFill = "url(#rainbowGradient)";
        eggContainer.innerHTML = `
          <svg viewBox="0 0 100 100">
            <defs>
              <linearGradient id="rainbowGradient">
                <stop offset="0%" stop-color="red"/>
                <stop offset="16%" stop-color="orange"/>
                <stop offset="33%" stop-color="yellow"/>
                <stop offset="50%" stop-color="green"/>
                <stop offset="66%" stop-color="blue"/>
                <stop offset="83%" stop-color="indigo"/>
                <stop offset="100%" stop-color="violet"/>
              </linearGradient>
            </defs>
            <circle cx="50" cy="50" r="35" fill="${monkeyFill}"/>
            <circle cx="25" cy="35" r="12" fill="${monkeyFill}"/>
            <circle cx="75" cy="35" r="12" fill="${monkeyFill}"/>
            <circle cx="40" cy="45" r="6" fill="white"/>
            <circle cx="60" cy="45" r="6" fill="white"/>
            <circle cx="40" cy="45" r="3" fill="black"/>
            <circle cx="60" cy="45" r="3" fill="black"/>
            <ellipse cx="50" cy="55" rx="7" ry="5" fill="#6B3410"/>
          </svg>
        `;
      } else {
        // Original non-rainbow monkey code
        eggContainer.innerHTML = `
          <svg viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="35" fill="${monkeyFill}"/>
            <circle cx="25" cy="35" r="12" fill="${monkeyFill}"/>
            <circle cx="75" cy="35" r="12" fill="${monkeyFill}"/>
            <circle cx="40" cy="45" r="6" fill="white"/>
            <circle cx="60" cy="45" r="6" fill="white"/>
            <circle cx="40" cy="45" r="3" fill="black"/>
            <circle cx="60" cy="45" r="3" fill="black"/>
            <ellipse cx="50" cy="55" rx="7" ry="5" fill="#6B3410"/>
          </svg>
        `;
      }
      
      setTimeout(() => {
        document.body.removeChild(overlay);
      }, 1500);
    }, 1000);
  }, 1000);
}

function buyEgg() {
  if (game.bananas >= game.eggCost) {
    game.bananas -= game.eggCost;
    game.eggCost = Math.ceil(game.eggCost * 1.5);
    hatchEgg();
    updateDisplay();
  }
}

function hatchEgg() {
  const rand = Math.random() * (100 - game.eggLuck) / 100; // Reduces the random range based on luck
  let selectedType = monkeyTypes[0];
  let cumulative = 0;
  
  for (const type of monkeyTypes) {
    cumulative += type.chance;
    if (rand <= cumulative) {
      selectedType = type;
      break;
    }
  }

  const monkey = {
    type: selectedType.name,
    clickValue: selectedType.clickValue,
    color: selectedType.color
  };

  showEggAnimation(selectedType);
  
  game.monkeys.push(monkey);
  updateInventory();
}

function updateInventory() {
  const inventory = document.getElementById('inventory');
  inventory.innerHTML = '';
  
  game.monkeys.forEach((monkey, index) => {
    const card = document.createElement('div');
    card.className = 'monkey-card';
    if (game.equippedMonkey === monkey) {
      card.classList.add('equipped');
    }
    
    if (monkey.type === "Epic Rainbow Monkey") {
      card.style.background = "linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet)";
    } else {
      card.style.background = monkey.color;
    }
    
    card.innerHTML = `
      <h4>${monkey.type}</h4>
      <p>${monkey.clickValue} bananas per click</p>
    `;
    card.onclick = () => equipMonkey(index);
    inventory.appendChild(card);
  });
}

setInterval(() => {
  game.bananas += game.bananasPerSecond * game.rebirthBonus;
  updateDisplay();
}, 1000);

function buyMergeStation() {
  if (game.bananas >= 10000) {
    game.bananas -= 10000;
    document.getElementById('mergeStation').style.display = 'block';
    updateDisplay();
  }
}

function countMonkeysByType(type) {
  return game.monkeys.filter(monkey => monkey.type === type).length;
}

function updateMergeButtons() {
  const redCount = countMonkeysByType('Uncommon Red Monkey');
  const goldCount = countMonkeysByType('Rare Golden Monkey');
  const rainbowCount = countMonkeysByType('Epic Rainbow Monkey');

  const buttons = document.querySelectorAll('.merge-button');
  buttons[0].classList.toggle('disabled', redCount < 5);
  buttons[1].classList.toggle('disabled', goldCount < 5);
  buttons[2].classList.toggle('disabled', rainbowCount < 5);
}

function mergeMonkeys(targetType) {
  let sourceType;
  if (targetType === 'Rare Golden Monkey') sourceType = 'Uncommon Red Monkey';
  if (targetType === 'Epic Rainbow Monkey') sourceType = 'Rare Golden Monkey';
  if (targetType === 'Legendary Galaxy Monkey') sourceType = 'Epic Rainbow Monkey';

  const sourceMonkeys = game.monkeys.filter(monkey => monkey.type === sourceType);
  
  if (sourceMonkeys.length >= 5) {
    // Remove 5 source monkeys
    let removed = 0;
    game.monkeys = game.monkeys.filter(monkey => {
      if (monkey.type === sourceType && removed < 5) {
        removed++;
        return false;
      }
      return true;
    });

    // Add new merged monkey
    const newMonkey = monkeyTypes.find(type => type.name === targetType);
    game.monkeys.push({
      type: newMonkey.name,
      clickValue: newMonkey.clickValue,
      color: newMonkey.color
    });

    // Reset equipped monkey if it was removed
    if (game.equippedMonkey && game.equippedMonkey.type === sourceType) {
      game.equippedMonkey = null;
      game.bananasPerClick = 1; // Reset to base value since no monkey equipped
    }

    updateDisplay();
    updateInventory();
  }
}

function buyJungleAccess() {
  if (game.bananas >= 100000) {
    game.bananas -= 100000;
    transitionToJungle();
    updateDisplay();
  }
}

function transitionToJungle() {
  const transition = document.querySelector('.level-transition');
  transition.classList.add('active');
  
  setTimeout(() => {
    document.body.classList.add('jungle-mode');
    game.inJungle = true;
    // Show jungle items
    document.querySelectorAll('.jungle-item').forEach(item => {
      item.style.display = 'block';
    });
    
    setTimeout(() => {
      transition.classList.remove('active');
    }, 1000);
  }, 1000);
}

function buyJungleEgg() {
  if (game.bananas >= game.jungleEggCost) {
    game.bananas -= game.jungleEggCost;
    game.jungleEggCost = Math.ceil(game.jungleEggCost * 1.5);
    hatchJungleEgg();
    updateDisplay();
  }
}

function hatchJungleEgg() {
  const rand = Math.random() * (100 - game.eggLuck) / 100;
  let selectedType = jungleMonkeys[0];
  let cumulative = 0;
  
  for (const type of jungleMonkeys) {
    cumulative += type.chance;
    if (rand <= cumulative) {
      selectedType = type;
      break;
    }
  }

  const monkey = {
    type: selectedType.name,
    clickValue: selectedType.clickValue,
    color: selectedType.color
  };

  showEggAnimation(selectedType);
  game.monkeys.push(monkey);
  updateInventory();
}

function buyMysticalEgg() {
  if (game.bananas >= game.mysticalEggCost) {
    game.bananas -= game.mysticalEggCost;
    game.mysticalEggCost = Math.ceil(game.mysticalEggCost * 1.5);
    hatchMysticalEgg();
    updateDisplay();
  }
}

function hatchMysticalEgg() {
  const rand = Math.random() * (100 - game.eggLuck) / 100;
  let selectedType = mysticalMonkeys[0];
  let cumulative = 0;
  
  for (const type of mysticalMonkeys) {
    cumulative += type.chance;
    if (rand <= cumulative) {
      selectedType = type;
      break;
    }
  }

  const monkey = {
    type: selectedType.name,
    clickValue: selectedType.clickValue,
    color: selectedType.color
  };

  showEggAnimation(selectedType);
  game.monkeys.push(monkey);
  updateInventory();
}

function rebirth() {
  if (game.bananas >= 10000000) {
    // Increment rebirth level
    game.rebirthLevel++;
    game.rebirthBonus = 1 + (game.rebirthLevel * 0.5); // 50% increase per rebirth
    
    // Reset game state but keep rebirth stats
    game.bananas = 0;
    game.bananasPerClick = 1;
    game.bananasPerSecond = 0;
    game.clickPowerCost = 10;
    game.autoClickCost = 50;
    game.eggCost = 100;
    game.eggLuck = 0;
    game.eggLuckCost = 500;
    game.jungleClickCost = 50000;
    game.jungleEggCost = 100000;
    game.mysticalEggCost = 250000;
    game.monkeys = [];
    game.equippedMonkey = null;
    game.inJungle = false;
    
    // Reset visual elements
    document.body.classList.remove('jungle-mode');
    document.querySelectorAll('.jungle-item').forEach(item => {
      item.style.display = 'none';
    });
    document.getElementById('mergeStation').style.display = 'none';
    
    // Show rebirth effect
    const transition = document.querySelector('.level-transition');
    transition.style.background = 'linear-gradient(45deg, #FF1493, #9400D3)';
    transition.classList.add('active');
    setTimeout(() => {
      transition.classList.remove('active');
      transition.style.background = 'black';
    }, 2000);
    
    updateDisplay();
    updateInventory();
  }
}

updateDisplay();
</script>

<script>
// Animate clouds
const clouds = document.querySelectorAll('.cloud');
clouds.forEach((cloud, index) => {
  const speed = 0.02 + (index * 0.01);
  let position = index * 20;
  
  setInterval(() => {
    position += speed;
    if (position > 100) position = -20;
    cloud.style.transform = `translate(${position}%, ${20 + (index * 5)}%)`;
  }, 50);
});

// Animate birds
const birds = document.querySelector('.birds');
let birdPos = 0;
setInterval(() => {
  birdPos += 0.1;
  if (birdPos > 100) birdPos = -20;
  birds.style.transform = `translate(${birdPos}%, 0)`;
}, 50);
</script>
</body></html>
<style>
body {
  margin: 0;
  padding: 0;
  background-color: #000;
  overflow: hidden;
  font-family: 'Press Start 2P', cursive;
}

#game-container {
  width: 100vw;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

#game-canvas {
  border: 4px solid #ff0000;
  box-shadow: 0 0 20px #ff0000, inset 0 0 20px #ff0000;
  border-radius: 10px;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

#menu {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  color: #ff0000;
  text-shadow: 0 0 10px #ff0000;
}

#menu h1 {
  font-size: 48px;
  margin-bottom: 40px;
}

.menu-btn {
  display: block;
  width: 200px;
  margin: 20px auto;
  padding: 15px;
  background-color: transparent;
  border: 2px solid #ff0000;
  color: #ff0000;
  font-family: 'Press Start 2P', cursive;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
}

.menu-btn:hover {
  background-color: #ff0000;
  color: #000;
  box-shadow: 0 0 20px #ff0000;
}

#help-modal {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #000;
  border: 2px solid #ff0000;
  padding: 20px;
  color: #ff0000;
  text-align: left;
  max-width: 80%;
  box-shadow: 0 0 20px #ff0000;
}

#mobile-controls {
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.mobile-btn {
  width: 60px;
  height: 60px;
  margin: 0 10px;
  background-color: rgba(255, 0, 0, 0.3);
  border: 2px solid #ff0000;
  border-radius: 50%;
  color: #ff0000;
  font-size: 24px;
  touch-action: manipulation;
}

@media (max-width: 768px) {
  #mobile-controls {
    display: block;
  }
  
  #game-canvas {
    max-width: 100%;
    height: auto;
  }
}

#hud {
  color: #ff0000;
  font-size: 16px;
  margin-top: 20px;
  display: flex;
  justify-content: space-between;
  width: 800px;
  text-shadow: 2px 2px #000;
}

#game-over, #level-up {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #ff0000;
  font-size: 32px;
  text-align: center;
  display: none;
  text-shadow: 4px 4px #000;
}

#restart-btn, #next-level-btn {
  margin-top: 20px;
  padding: 10px 20px;
  font-size: 18px;
  background-color: #ff0000;
  color: #000;
  border: none;
  cursor: pointer;
  font-family: 'Press Start 2P', cursive;
}

.glow {
  filter: drop-shadow(0 0 10px #ff0000);
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
<div id="menu">
  <h1>Red Space Invaders</h1>
  <button class="menu-btn" id="play-btn">Play</button>
  <button class="menu-btn" id="help-btn">Help</button>
</div>

<div id="help-modal">
  <h2>How to Play</h2>
  <p>Use LEFT and RIGHT arrows to move</p>
  <p>Press SPACE to shoot</p>
  <p>Destroy all aliens to advance to next level</p>
  <p>Survive 20 levels and defeat the boss!</p>
  <button class="menu-btn" id="close-help">Close</button>
</div>

<div id="game-container" style="display: none;">
  <canvas id="game-canvas" width="800" height="600"></canvas>
  <div id="hud">
    <div>Score: <span id="score-value">0</span></div>
    <div>Level: <span id="level-value">1</span></div>
    <div>Lives: <span id="lives-value">3</span></div>
  </div>
</div>

<div id="mobile-controls">
  <button class="mobile-btn" id="left-btn">←</button>
  <button class="mobile-btn" id="shoot-btn">•</button>
  <button class="mobile-btn" id="right-btn">→</button>
</div>

<div id="game-over">
  Game Over<br>
  <button id="restart-btn">Restart</button>
</div>

<div id="level-up">
  Level Complete!<br>
  <button id="next-level-btn">Next Level</button>
</div>

<script>
const canvas = document.getElementById('game-canvas');
const ctx = canvas.getContext('2d');
const scoreElement = document.getElementById('score-value');
const levelElement = document.getElementById('level-value');
const livesElement = document.getElementById('lives-value');
const gameOverElement = document.getElementById('game-over');
const levelUpElement = document.getElementById('level-up');
const restartBtn = document.getElementById('restart-btn');
const nextLevelBtn = document.getElementById('next-level-btn');

// Add these const declarations right after the first group of element references
const playBtn = document.getElementById('play-btn');
const helpBtn = document.getElementById('help-btn');
const closeHelpBtn = document.getElementById('close-help');
const helpModal = document.getElementById('help-modal');
const menu = document.getElementById('menu');
const gameContainer = document.getElementById('game-container');
const leftBtn = document.getElementById('left-btn');
const rightBtn = document.getElementById('right-btn');
const shootBtn = document.getElementById('shoot-btn');

const INVADER_ROWS = 5;
const INVADER_COLS = 11;
const INVADER_SPACING = 10;
const PLAYER_WIDTH = 60;
const PLAYER_HEIGHT = 20;
const PLAYER_SPEED = 5;
const BULLET_WIDTH = 3;
const BULLET_HEIGHT = 15;
const BULLET_SPEED = 7;

let invaders = [];
let player = {
  x: canvas.width / 2 - PLAYER_WIDTH / 2,
  y: canvas.height - PLAYER_HEIGHT - 10
};
let bullets = [];
let enemyBullets = [];
let leftPressed = false;
let rightPressed = false;
let spacePressed = false;
let score = 0;
let level = 1;
let lives = 3;
let gameOver = false;
let levelComplete = false;
let invaderDirection = 1;

const alienTypes = [
  { color: '#ff0000', points: 10, shootInterval: 3000, width: 40, height: 30 },
  { color: '#ff3333', points: 20, shootInterval: 2500, width: 45, height: 35 },
  { color: '#ff6666', points: 30, shootInterval: 2000, width: 50, height: 40 },
  { color: '#ff9999', points: 40, shootInterval: 1500, width: 55, height: 45 },
  { color: '#ffcccc', points: 50, shootInterval: 1000, width: 60, height: 50 }
];

function createInvaders() {
  invaders = [];
  for (let row = 0; row < INVADER_ROWS; row++) {
    for (let col = 0; col < INVADER_COLS; col++) {
      const alienType = alienTypes[Math.min(row, alienTypes.length - 1)];
      invaders.push({
        x: col * (alienType.width + INVADER_SPACING),
        y: row * (alienType.height + INVADER_SPACING) + 50,
        width: alienType.width,
        height: alienType.height,
        type: alienType,
        lastShot: 0
      });
    }
  }
}

function drawInvader(invader) {
  ctx.save();
  ctx.shadowColor = invader.type.color;
  ctx.shadowBlur = 5;
  
  ctx.fillStyle = invader.type.color;
  ctx.fillRect(invader.x, invader.y, invader.width, invader.height);
  
  ctx.fillStyle = '#000';
  const eyeWidth = Math.max(4, invader.width * 0.15);
  const eyeHeight = Math.max(4, invader.height * 0.15);
  ctx.fillRect(invader.x + invader.width * 0.2, invader.y + invader.height * 0.3, eyeWidth, eyeHeight);
  ctx.fillRect(invader.x + invader.width * 0.65, invader.y + invader.height * 0.3, eyeWidth, eyeHeight);
  
  ctx.fillRect(invader.x + invader.width * 0.3, invader.y + invader.height * 0.7, 
               invader.width * 0.4, Math.max(3, invader.height * 0.1));
  
  ctx.restore();
}

function drawInvaders() {
  invaders.forEach(invader => {
    drawInvader(invader);
  });
}

function drawPlayer() {
  ctx.save();
  ctx.shadowColor = '#ff0000';
  ctx.shadowBlur = 5;
  
  ctx.fillStyle = '#ff0000';
  ctx.beginPath();
  ctx.moveTo(player.x, player.y + PLAYER_HEIGHT);
  ctx.lineTo(player.x + PLAYER_WIDTH/2, player.y);
  ctx.lineTo(player.x + PLAYER_WIDTH, player.y + PLAYER_HEIGHT);
  ctx.closePath();
  ctx.fill();
  
  ctx.fillRect(player.x + PLAYER_WIDTH/2 - 2, player.y - 8, 4, 12);
  
  ctx.restore();
}

function drawBullets() {
  ctx.save();
  ctx.shadowColor = '#ff0000';
  ctx.shadowBlur = 5;
  
  ctx.fillStyle = '#ff0000';
  bullets.forEach(bullet => {
    ctx.fillRect(bullet.x, bullet.y, BULLET_WIDTH, BULLET_HEIGHT);
  });
  
  ctx.fillStyle = '#ff6666';
  enemyBullets.forEach(bullet => {
    ctx.fillRect(bullet.x, bullet.y, BULLET_WIDTH, BULLET_HEIGHT);
  });
  
  ctx.restore();
}

function movePlayer() {
  if (leftPressed && player.x > 0) {
    player.x -= PLAYER_SPEED;
  }
  if (rightPressed && player.x < canvas.width - PLAYER_WIDTH) {
    player.x += PLAYER_SPEED;
  }
}

function moveBullets() {
  bullets.forEach(bullet => {
    bullet.y -= BULLET_SPEED;
  });
  bullets = bullets.filter(bullet => bullet.y > 0);
  
  enemyBullets.forEach(bullet => {
    bullet.y += BULLET_SPEED * 0.5;
  });
  enemyBullets = enemyBullets.filter(bullet => bullet.y < canvas.height);
}

function moveInvaders() {
  let shouldChangeDirection = false;
  invaders.forEach(invader => {
    invader.x += invaderDirection;
    if (invader.x <= 0 || invader.x + invader.width >= canvas.width) {
      shouldChangeDirection = true;
    }
  });
  
  if (shouldChangeDirection) {
    invaderDirection *= -1;
  }
}

function checkCollisions() {
  bullets.forEach((bullet, bulletIndex) => {
    invaders.forEach((invader, invaderIndex) => {
      if (
        bullet.x < invader.x + invader.width &&
        bullet.x + BULLET_WIDTH > invader.x &&
        bullet.y < invader.y + invader.height &&
        bullet.y + BULLET_HEIGHT > invader.y
      ) {
        bullets.splice(bulletIndex, 1);
        invaders.splice(invaderIndex, 1);
        score += invader.type.points;
        scoreElement.textContent = score;
      }
    });
  });
  
  enemyBullets.forEach((bullet, bulletIndex) => {
    if (
      bullet.x < player.x + PLAYER_WIDTH &&
      bullet.x + BULLET_WIDTH > player.x &&
      bullet.y < player.y + PLAYER_HEIGHT &&
      bullet.y + BULLET_HEIGHT > player.y
    ) {
      enemyBullets.splice(bulletIndex, 1);
      lives--;
      livesElement.textContent = lives;
      if (lives <= 0) {
        gameOver = true;
      }
    }
  });
}

function drawStars() {
  ctx.fillStyle = '#ff0000';
  for (let i = 0; i < 50; i++) {
    const size = Math.random() < 0.3 ? 2 : 1;
    ctx.fillRect(
      Math.random() * canvas.width,
      Math.random() * canvas.height,
      size,
      size
    );
  }
}

function enemyShoot() {
  invaders.forEach(invader => {
    if (Math.random() < 0.001 && Date.now() - invader.lastShot > invader.type.shootInterval) {
      enemyBullets.push({
        x: invader.x + invader.width / 2,
        y: invader.y + invader.height
      });
      invader.lastShot = Date.now();
    }
  });
}

function drawBoss() {
  ctx.save();
  ctx.shadowColor = '#ff0000';
  ctx.shadowBlur = 10;
  
  ctx.fillStyle = '#ff0000';
  ctx.fillRect(canvas.width/2 - 100, 50, 200, 100);
  
  ctx.fillStyle = '#000';
  ctx.fillRect(canvas.width/2 - 60, 80, 40, 40);
  ctx.fillRect(canvas.width/2 + 20, 80, 40, 40);
  
  ctx.fillRect(canvas.width/2 - 60, 130, 120, 10);
  
  ctx.restore();
}

function gameLoop() {
  if (gameOver) {
    gameOverElement.style.display = 'block';
    return;
  }
  
  if (levelComplete) {
    levelUpElement.style.display = 'block';
    return;
  }
  
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  drawStars();
  if (level === 20) {
    drawBoss();
  } else {
    drawInvaders();
  }
  drawPlayer();
  drawBullets();
  
  movePlayer();
  moveBullets();
  moveInvaders();
  enemyShoot();
  checkCollisions();
  
  if (invaders.length === 0) {
    levelComplete = true;
  }
  
  requestAnimationFrame(gameLoop);
}

function startGame() {
  invaders = [];
  bullets = [];
  enemyBullets = [];
  player = {
    x: canvas.width / 2 - PLAYER_WIDTH / 2,
    y: canvas.height - PLAYER_HEIGHT - 10
  };
  score = 0;
  level = 1;
  lives = 3;
  gameOver = false;
  levelComplete = false;
  invaderDirection = 1;
  scoreElement.textContent = score;
  levelElement.textContent = level;
  livesElement.textContent = lives;
  gameOverElement.style.display = 'none';
  levelUpElement.style.display = 'none';
  createInvaders();
  gameLoop();
}

function nextLevel() {
  level++;
  if (level > 20) {
    gameOver = true;
    gameOverElement.style.display = 'block';
    return;
  }
  levelElement.textContent = level;
  levelComplete = false;
  levelUpElement.style.display = 'none';
  createInvaders();
  gameLoop();
}

document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowLeft') leftPressed = true;
  if (e.key === 'ArrowRight') rightPressed = true;
  if (e.key === ' ') spacePressed = true;
});

document.addEventListener('keyup', (e) => {
  if (e.key === 'ArrowLeft') leftPressed = false;
  if (e.key === 'ArrowRight') rightPressed = false;
  if (e.key === ' ') {
    spacePressed = false;
    if (!gameOver && !levelComplete) {
      bullets.push({
        x: player.x + PLAYER_WIDTH / 2 - BULLET_WIDTH / 2,
        y: player.y - BULLET_HEIGHT
      });
    }
  }
});

restartBtn.addEventListener('click', () => {
  gameContainer.style.display = 'none';
  menu.style.display = 'block';
  gameOverElement.style.display = 'none';
});

nextLevelBtn.addEventListener('click', nextLevel);

playBtn.addEventListener('click', () => {
  menu.style.display = 'none';
  gameContainer.style.display = 'flex';
  startGame();
});

helpBtn.addEventListener('click', () => {
  helpModal.style.display = 'block';
  menu.style.display = 'none';
});

closeHelpBtn.addEventListener('click', () => {
  helpModal.style.display = 'none';
  menu.style.display = 'block';
});

leftBtn.addEventListener('touchstart', (e) => {
  e.preventDefault();
  leftPressed = true;
});

leftBtn.addEventListener('touchend', () => {
  leftPressed = false;
});

rightBtn.addEventListener('touchstart', (e) => {
  e.preventDefault();
  rightPressed = true;
});

rightBtn.addEventListener('touchend', () => {
  rightPressed = false;
});

shootBtn.addEventListener('touchstart', (e) => {
  e.preventDefault();
  if (!gameOver && !levelComplete) {
    bullets.push({
      x: player.x + PLAYER_WIDTH / 2 - BULLET_WIDTH / 2,
      y: player.y - BULLET_HEIGHT
    });
  }
});

startGame();
</script>
</body></html>